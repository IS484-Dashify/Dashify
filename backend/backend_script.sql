DROP DATABASE IF EXISTS IS484;
CREATE DATABASE IS484;
USE IS484;

CREATE TABLE SERVICES(
    SID INTEGER PRIMARY KEY,
    NAME TEXT
);

INSERT INTO SERVICES(SID, NAME) VALUES(1, 'Service 1');
INSERT INTO SERVICES(SID, NAME) VALUES(2, 'Service 2');
INSERT INTO SERVICES(SID, NAME) VALUES(3, 'Service 3');

CREATE TABLE MACHINES(
    MID INTEGER,
    SID INTEGER,
    NAME TEXT,
    LOCATION TEXT,
    PRIMARY KEY(MID, SID),
    FOREIGN KEY(SID) REFERENCES SERVICES(SID)
);

CREATE TABLE COMPONENTS(
    CID INTEGER,
    MID INTEGER,
    NAME TEXT,
    PRIMARY KEY(CID, MID),
    FOREIGN KEY(MID) REFERENCES MACHINES(MID)
);

CREATE TABLE RESULTS(
    DATETIME DATETIME,
    MID INTEGER,
    CID INTEGER,
    DISK_USAGE FLOAT,
    TRAFFIC_IN INTEGER,
    TRAFFIC_OUT INTEGER,
    CLOCK FLOAT,
    CPU_USAGE FLOAT,
    SYSTEM_UPTIME FLOAT,
    MEMORY_USAGE FLOAT,
    PRIMARY KEY(DATETIME, MID, CID),
    FOREIGN KEY(MID, CID) REFERENCES COMPONENTS(MID, CID)
);